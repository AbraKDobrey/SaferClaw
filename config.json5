// /home/openclaw/.openclaw/config.json5
// OpenClaw Autonomous Bot Configuration
// ====================================
// 
// INSTRUCTIONS:
// 1. Copy this file to ~/.openclaw/config.json5
// 2. Replace the placeholder Telegram user ID (0) with your real Telegram user ID
// 3. Replace YOUR_DOMAIN with your domain (e.g.: myopenclaw.duckdns.org)
// 4. Verify all tokens are set in .env.openclaw
//
{
  // ===== META =====
  meta: {
    lastTouchedVersion: "current",
    lastTouchedAt: "2026-02-05",
    profile: "autonomous-vps"
  },

  // ===== LOGGING =====
  logging: {
    level: "info",
    consoleLevel: "info",
    redactSensitive: "tools",
    file: "/var/log/openclaw/openclaw.log"
  },

  // ===== SESSION ISOLATION =====
  session: {
    dmScope: "per-channel-peer"
  },

  // ===== DISCOVERY - OFF =====
  discovery: {
    mdns: {
      mode: "off"  // CRITICAL: no LAN discovery
    }
  },

  // ===== DIAGNOSTICS - OFF =====
  diagnostics: {
    otel: {
      enabled: false
    }
  },

  // ===== GATEWAY =====
  gateway: {
    port: 47832,
    bind: "loopback",
    
    auth: {
      mode: "token"
      // Token via env: OPENCLAW_GATEWAY_TOKEN
    },
    
    controlUi: {
      enabled: false
    },
    
    trustedProxies: ["127.0.0.1"],
    
    http: {
      endpoints: {
        chatCompletions: { enabled: false },
        responses: { enabled: false }
      }
    },
    
    nodes: {
      denyCommands: ["*"]
    },
    
    tailscale: { mode: "off" },
    reload: { mode: "off" }
  },

  // ===== TOOLS - AUTONOMOUS =====
  tools: {
    profile: "full",
    
    deny: [
      "gateway",
      "nodes"
    ],
    
    elevated: {
      enabled: false
    },
    
    exec: {
      host: "local",
      security: "full",
      ask: "off",
      autoAllowSkills: false,  // CRITICAL: no auto-approve of skill binaries
      timeoutSec: 600,
      backgroundMs: 30000,
      cleanupMs: 300000,
      notifyOnExit: true,
      ptyDefault: true,
      applyPatch: {
        enabled: true
      }
    },
    
    sandbox: {
      tools: {
        deny: ["gateway", "nodes"]
      }
    },
    
    subagents: {
      tools: {
        deny: ["gateway", "nodes"]
      }
    },
    
    message: {
      allowCrossContextSend: true,
      crossContext: {
        allowWithinProvider: true,
        allowAcrossProviders: false
      },
      broadcast: {
        enabled: true
      }
    },
    
    agentToAgent: {
      enabled: true
    },
    
    web: {
      search: {
        enabled: true,
        maxResults: 20,
        timeoutSeconds: 30
      },
      fetch: {
        enabled: true,
        maxChars: 100000,
        timeoutSeconds: 60,
        maxRedirects: 5
      }
    }
  },

  // ===== AGENTS - NATIVE (NO DOCKER) =====
  agents: {
    defaults: {
      // Default model - via OpenRouter
      model: { primary: "openrouter/x-ai/grok-4.1-fast" },
      
      sandbox: {
        mode: "off",  // No Docker - tools run directly on host
        
        browser: {
          enabled: false
        }
      },
      
      elevatedDefault: "off",
      timeoutSeconds: 1800,
      maxConcurrent: 3,
      contextTokens: 150000,
      
      subagents: {
        maxConcurrent: 5,
        archiveAfterMinutes: 120
      },
      
      memory: {
        enabled: true,
        provider: "local",
        sources: ["memory"],
        sync: {
          intervalMinutes: 5,
          onBoot: true
        },
        remote: {
          batch: { enabled: false }
        }
      }
    }
  },

  // ===== TELEGRAM CHANNEL =====
  channels: {
    telegram: {
      enabled: true,
      // botToken via env: TELEGRAM_BOT_TOKEN
      
      dmPolicy: "allowlist",
      allowFrom: [
        // REPLACE with your Telegram user ID (find via @userinfobot in Telegram)
        0
      ],
      
      groupPolicy: "disabled",
      configWrites: true,
      streamMode: "partial",
      
      actions: {
        reactions: true,
        sendMessage: true,
        deleteMessage: true,
        sticker: false
      },
      
      reactionLevel: "ack",
      historyLimit: 100,
      dmHistoryLimit: 200,
      textChunkLimit: 4000
      
      // Webhook configuration - REPLACE YOUR_DOMAIN
      webhookUrl: "https://YOUR_DOMAIN/tg/webhook",
      webhookPath: "/tg/webhook"
      // webhookSecret is set via env var TELEGRAM_WEBHOOK_SECRET
    },
    
    defaults: {
      groupPolicy: "disabled"
    }
  },

  // ===== SKILLS =====
  skills: {
    allowBundled: [
      "cursor-cli",      // PRIMARY coding tool - Cursor CLI agents
      "coding-agent",    // Fallback: Codex/Claude Code/Pi
      "tmux",
      "summarize",
      "github",
      "weather",
      "session-logs",
      "openai-whisper",
      "openai-whisper-api",
      "canvas",
      "oracle",
      "healthcheck",
      "himalaya"
    ],
    
    load: {
      watch: false,
      extraDirs: []
    },
    
    entries: {
      "skill-creator": { enabled: false },
      "clawhub": { enabled: false },
      "mcporter": { enabled: false },
      "camsnap": { enabled: false }
    }
  },

  // ===== HOOKS =====
  hooks: {
    enabled: true,
    path: "/hooks",
    maxBodyBytes: 2097152
  },

  // ===== CRON =====
  cron: {
    enabled: true,
    jobs: [
      {
        id: "daily-briefing",
        name: "Daily Briefing",
        enabled: true,
        schedule: { cron: "0 8 * * *" },
        sessionTarget: "main",
        wakeMode: "now",
        payload: {
          kind: "agentTurn",
          message: "Good morning! What's on the schedule for today?",
          deliver: true,
          channel: "telegram",
          // REPLACE with your Telegram user ID
          to: "0"
        }
      }
    ]
  },

  // ===== APPROVALS - OFF =====
  approvals: {
    exec: {
      enabled: false
    }
  },

  // ===== BROWSER - OFF =====
  browser: {
    enabled: false
  },

  // ===== PLUGINS - OFF =====
  plugins: {
    enabled: false
  }
}
